<%- include('partials/header') %>
   <%- include('partials/loader') %>
      <%- include('partials/sidebar') %>

         <%- include('partials/topbar') %>


            <div class="conatiner-fluid content-inner mt-n5 py-0">

               <div id="user-role" data-permissions="<%= permissions %>"></div>
               <style>
                  .plus-icon {
                     color: #5a6474;
                     transition: color 0.3s ease-in-out;
                     font-size: 18px;

                  }

                  .plus-icon:hover {
                     color: #8a92a6;
                  }

                  .plus-spacing {
                     margin-left: 7px;
                     /* Pwede mong dagdagan kung masyadong dikit pa rin */
                  }

                  li.card {
                     width: 291px !important;
                     /* adjust as needed */
                  }

                  .d-slider1 .swiper-button-next:after {
                     color: #000 !important;
                     font-weight: bold !important;
                     /* Make the arrows bold */
                     opacity: 1 !important;
                     /* Ensure buttons are fully opaque */
                     transition: none !important;
                     visibility: visible !important;
                     /* Disable any transition */
                     /* Ensure the color is applied */
                  }

                  .d-slider1 .swiper-button-prev:after {
                     color: #000 !important;
                     font-weight: bold !important;
                     /* Make the arrows bold */
                     opacity: 1 !important;
                     /* Ensure buttons are fully opaque */
                     transition: none !important;
                     visibility: visible !important;
                     /* Disable any transition */
                     /* Ensure the color is applied */
                  }

                  .d-slider1 .swiper-button-next:before {
                     color: #000 !important;
                     font-weight: bold !important;
                     /* Make the arrows bold */
                     opacity: 1 !important;
                     /* Ensure buttons are fully opaque */
                     transition: none !important;
                     visibility: visible !important;
                     /* Disable any transition */
                     /* Ensure the color is applied */
                  }

                  .d-slider1 .swiper-button-prev:before {
                     color: #000 !important;
                     font-weight: bold !important;
                     /* Make the arrows bold */
                     opacity: 1 !important;
                     /* Ensure buttons are fully opaque */
                     transition: none !important;
                     visibility: visible !important;
                     /* Disable any transition */
                     /* Ensure the color is applied */
                  }

                  /* If the arrows are SVG, make sure the fill color stays black */
                  .d-slider1 .swiper-button-next svg,
                  .d-slider1 .swiper-button-prev svg {
                     fill: #000 !important;
                     /* Change fill color to black */
                     opacity: 1 !important;
                     /* Ensure buttons are fully opaque */
                     visibility: visible !important;
                     transition: none !important;
                     /* Disable any transition */
                  }

                  /* Prevent color change on hover and active states */
                  .d-slider1 .swiper-button-next:hover,
                  .d-slider1 .swiper-button-prev:hover,
                  .d-slider1 .swiper-button-next:active,
                  .d-slider1 .swiper-button-prev:active {
                     color: #000 !important;
                     /* Ensure color stays black */
                     fill: #000 !important;
                     /* Ensure fill stays black */
                     opacity: 1 !important;
                     /* Ensure buttons are fully opaque */
                     visibility: visible !important;
                     transition: none !important;
                     /* Disable any transition */
                  }

                  .my-custom-next,
                  .my-custom-prev {
                     color: #000;
                     /* Always black text/icon */
                     font-weight: bold;
                     /* Make them bold if you want */
                     cursor: pointer;
                     /* Show pointer on hover */
                     transition: none;
                     /* Disable transitions */
                     /* Add any other styling you need, e.g. padding, positioning, etc. */
                  }

                  /* Hover/active states (optional) */
                  .my-custom-next:hover,
                  .my-custom-prev:hover,
                  .my-custom-next:active,
                  .my-custom-prev:active {
                     color: #000;
                     /* Keep it black even on hover/click */
                     transition: none;
                  }

                  /* Ensuring transfer account stays on top while keeping guest account in the background */
                  #modal-guestAccount {
                     z-index: 1050 !important;
                     /* Default z-index */
                  }

                  #modal-account-details {
                     z-index: 1060 !important;
                     /* Account details modal above guest account */
                  }

                  #modal-transfer_account {
                     z-index: 1070 !important;
                     /* Transfer modal above everything */
                  }

                  /* Optional: Apply backdrop effect for modals */
                  .modal-backdrop {
                     z-index: 1040 !important;
                     /* Ensure backdrop stays behind the account details */
                  }
               </style>
                              <!-- CARDS -->
               <form id="expense-form" action="/insert-dash-history" method="POST">
                  <% if (permissions !== 1 && !isKimsBrothersDashboard) { %>
                  <div class="row">
                     <div class="col-md-12 col-lg-12">
                        <div class="row row-cols-1">
                           <div class="overflow-hidden d-slider1 ">

                              <ul class="p-0 m-0 mb-2 swiper-wrapper list-inline">

                                 <!-- Card 1: Today's Revenue -->
                                 <li class="swiper-slide card card-slide" data-aos="fade-up" data-aos-delay="700">
                                    <div class="card-body">
                                       <div class="progress-widget">
                                          <div class="p-3 mb-2 rounded bg-secondary-subtle">
                                             <svg class="icon-25" width="25" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/>
                                             </svg>
                                          </div>
                                          <div class="progress-detail">
                                             <h6 class="mb-2">
                                                <%= __('dashboard.todays_revenue') %>
                                             </h6>
                                             <h6 class="counter">₱ <%= typeof todaysRevenue !== 'undefined' ? todaysRevenue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '0.00' %></h6>
                                          </div>
                                       </div>
                                    </div>
                                 </li>

                                 <!-- Card 2: Total Orders -->
                                 <li class="swiper-slide card card-slide" data-aos="fade-up" data-aos-delay="800">
                                    <div class="card-body">
                                       <div class="progress-widget">
                                          <div class="p-3 mb-2 rounded bg-secondary-subtle">
                                             <svg class="icon-25" width="25" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                                             </svg>
                                          </div>
                                          <div class="progress-detail">
                                             <h6 class="mb-2">
                                                <%= __('dashboard.total_orders') %>
                                             </h6>
                                             <h6 class="counter"><%= typeof totalOrders !== 'undefined' ? totalOrders : '0' %></h6>
                                          </div>
                                       </div>
                                    </div>
                                 </li>

                                 <!-- Card 3: Active Tables -->
                                 <li class="swiper-slide card card-slide" data-aos="fade-up" data-aos-delay="900">
                                    <div class="card-body">
                                       <div class="progress-widget">
                                          <div class="p-3 mb-2 rounded bg-secondary-subtle">
                                             <svg class="icon-25" width="25" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/>
                                                <path d="M2 4h20v16H2z" fill="none" stroke="currentColor" stroke-width="2"/>
                                             </svg>
                                          </div>
                                          <div class="progress-detail">
                                             <h6 class="mb-2">
                                                <%= __('dashboard.active_tables') %>
                                             </h6>
                                             <h6 class="counter"><%= typeof activeTables !== 'undefined' ? activeTables : '0' %></h6>
                                          </div>
                                       </div>
                                    </div>
                                 </li>

                                 <!-- Card 4: Pending Orders -->
                                 <li class="swiper-slide card card-slide" data-aos="fade-up" data-aos-delay="1100">
                                    <div class="card-body">
                                       <div class="progress-widget">
                                          <div class="p-3 mb-2 rounded bg-secondary-subtle">
                                             <svg class="icon-25" width="25" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                                             </svg>
                                          </div>
                                          <div class="progress-detail">
                                             <h6 class="mb-2">
                                                <%= __('dashboard.pending_orders') %>
                                             </h6>
                                             <h6 class="counter"><%= typeof pendingOrders !== 'undefined' ? pendingOrders : '0' %></h6>
                                          </div>
                                       </div>
                                    </div>
                                 </li>
                                 <!-- Card 5: Popular Items -->
                                 <li class="swiper-slide card card-slide" data-aos="fade-up" data-aos-delay="1200">
                                    <div class="card-body">
                                       <div class="progress-widget">
                                          <div class="p-3 mb-2 rounded bg-secondary-subtle">
                                             <svg class="icon-25" width="25" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                                             </svg>
                                          </div>
                                          <div class="progress-detail">
                                             <h6 class="mb-2">
                                                <%= __('dashboard.popular_items') %>
                                             </h6>
                                             <h6 class="counter"><%= typeof popularItems !== 'undefined' ? popularItems : '0' %></h6>
                                          </div>
                                       </div>
                                    </div>
                                 </li>
                              </ul>
                              <div class="swiper-button swiper-button-next"></div>
                              <div class="swiper-button swiper-button-prev"></div>
                           </div>
                        </div>
                     </div>
                  </div>
                  <% } %>
                  <% if (isKimsBrothersDashboard) { %>
                  <!-- Kim's Brothers custom dashboard (static preview) -->
                  <div class="kb-sales-container">
                  <div class="row mt-4 mb-3 align-items-center kb-sales-header">
                     <div class="col-md-4 mb-2 mb-md-0">
                        <h4 class="mb-0">Sales Summary</h4>
                        <small class="text-muted">
                           Kim's Brothers branch · static preview
                        </small>
                     </div>
                     <div class="col-md-8 d-flex flex-wrap justify-content-md-end gap-2 kb-sales-filters">
                        <button type="button" id="kb-date-range-button" class="btn btn-outline-secondary btn-sm d-flex align-items-center gap-1 kb-filter-btn">
                           <i class="far fa-calendar"></i>
                           <span id="kb-date-range-label">29 Dec 2025 - 27 Jan 2026</span>
                        </button>
                        <input type="text" id="kb-date-range-input" class="d-none" />
                        <div class="kb-time-filter">
                           <button type="button" id="kb-time-filter-btn" class="btn btn-outline-secondary btn-sm d-flex align-items-center gap-1 kb-filter-btn">
                              <i class="far fa-clock"></i>
                              <span id="kb-time-filter-label">All day long</span>
                              <i class="fas fa-chevron-down small ms-1"></i>
                           </button>
                           <div class="kb-time-menu card shadow-sm" id="kb-time-menu">
                              <div class="kb-time-option">
                                 <label class="d-flex align-items-center gap-2 px-3 py-2 mb-0">
                                    <input type="radio" name="kb-time-mode" value="all_day" class="form-check-input" checked />
                                    <span>All day long</span>
                                 </label>
                              </div>
                              <div class="kb-time-option border-top">
                                 <label class="d-flex align-items-center gap-2 px-3 py-2 mb-0">
                                    <input type="radio" name="kb-time-mode" value="custom" class="form-check-input" />
                                    <span>Custom period</span>
                                 </label>
                                 <div class="kb-time-custom d-none px-3 pb-3" id="kb-time-custom-row">
                                    <div class="d-flex justify-content-between gap-2 mt-2">
                                       <div class="flex-fill">
                                          <small class="text-muted d-block mb-1">start</small>
                                          <select id="kb-time-start" class="form-select form-select-sm"></select>
                                       </div>
                                       <div class="flex-fill">
                                          <small class="text-muted d-block mb-1">end</small>
                                          <select id="kb-time-end" class="form-select form-select-sm"></select>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <button type="button" class="btn btn-outline-secondary btn-sm kb-filter-btn">
                           All employees
                        </button>
                     </div>
                  </div>

                  <div class="row g-3 mb-3 kb-summary-row">
                     <div class="col-md-3">
                        <div class="card kb-summary-card h-100">
                           <div class="card-body">
                              <div class="d-flex justify-content-between align-items-center mb-1">
                                 <span class="text-muted small">Total sales</span>
                              </div>
                              <div class="fs-4 fw-bold text-dark" id="kb-total-sales">₱5,072,900.00</div>
                              <small class="text-danger">-₱685,700.00 (-11.91%)</small>
                           </div>
                        </div>
                     </div>
                     <div class="col-md-2">
                        <div class="card kb-summary-card h-100">
                           <div class="card-body">
                              <span class="text-muted small d-block mb-1">refund</span>
                              <div class="fs-5 fw-bold text-dark" id="kb-refund">₱280.00</div>
                              <small class="text-muted">₱0.00 (0%)</small>
                           </div>
                        </div>
                     </div>
                     <div class="col-md-2">
                        <div class="card kb-summary-card h-100">
                           <div class="card-body">
                              <span class="text-muted small d-block mb-1">discount</span>
                              <div class="fs-5 fw-bold text-dark" id="kb-discount">₱17,180.00</div>
                              <small class="text-success">₱280.80 (1.61%)</small>
                           </div>
                        </div>
                     </div>
                     <div class="col-md-2">
                        <div class="card kb-summary-card h-100">
                           <div class="card-body">
                              <span class="text-muted small d-block mb-1">Net sales</span>
                              <div class="fs-5 fw-bold text-dark" id="kb-net-sales">₱5,055,440.00</div>
                              <small class="text-danger">-₱685,419.20 (-11.94%)</small>
                           </div>
                        </div>
                     </div>
                     <div class="col-md-3">
                        <div class="card kb-summary-card h-100">
                           <div class="card-body">
                              <span class="text-muted small d-block mb-1">Gross profit</span>
                              <div class="fs-5 fw-bold text-dark" id="kb-gross-profit">₱5,055,440.00</div>
                              <small class="text-danger">-₱685,269.20 (-11.94%)</small>
                           </div>
                        </div>
                     </div>
                  </div>

                  <div class="card mb-3">
                     <div class="card-header d-flex flex-wrap justify-content-between align-items-center gap-2">
                        <div>
                           <h6 class="mb-0">Total sales</h6>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                           <select class="form-select form-select-sm" id="kb-chart-type" style="width: 140px;">
                              <option value="bar" selected>Bar chart</option>
                              <option value="line">Line graph</option>
                           </select>
                           <select class="form-select form-select-sm" id="kb-view-mode" style="width: 130px;">
                              <option value="glance" selected>glance</option>
                              <option value="weekly">Weekly</option>
                              <option value="monthly">monthly</option>
                              <option value="quarterly">Quarterly</option>
                              <option value="yearly">By year</option>
                           </select>
                        </div>
                     </div>
                     <div class="card-body">
                        <div id="kb-sales-chart" style="min-height: 260px;"></div>
                     </div>
                  </div>

                  <div class="card">
                     <div class="card-header d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">EXPORT</h6>
                     </div>
                     <div class="card-body p-0">
                        <div class="table-responsive">
                           <table class="table table-striped mb-0">
                              <thead class="table-light">
                                 <tr>
                                    <th>date</th>
                                    <th class="text-end">Total sales</th>
                                    <th class="text-end">refund</th>
                                    <th class="text-end">discount</th>
                                    <th class="text-end">Net sales</th>
                                    <th class="text-end">Product unit price</th>
                                    <th class="text-end">Gross profit</th>
                                 </tr>
                              </thead>
                              <tbody id="kb-sales-table-body">
                                 <!-- Filled by static JS below -->
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
                  </div>
                  <% } %>
                  <% if (permissions === 1) {
                     const adminBranches = [
                        {
                           key: 'main',
                           name: 'Mainbranch',
                           accentClass: 'branch-main',
                           sales: '₱ 12,450,000',
                           delta: '+12.5%',
                           deltaClass: 'admin-badge-positive',
                           personnel: '₱ 2,480,000',
                           ratio: '19.9%',
                           inventoryStyle: 'good quality',
                           inventoryTag: 'Flagship',
                           inventoryDate: 'Updated today',
                           inventoryItems: [
                              { label: 'Korean beef', progress: 92, status: 'enough' },
                              { label: 'Vegetables', progress: 85, status: 'enough' },
                              { label: 'Seafood', progress: 78, status: 'in general' },
                              { label: 'Seasoning', progress: 80, status: 'enough' }
                           ]
                        },
                        {
                           key: 'makati',
                           name: 'Makati Branch',
                           accentClass: 'branch-makati',
                           sales: '₱ 8,780,000',
                           delta: '+3.2%',
                           deltaClass: 'admin-badge-positive',
                           personnel: '₱ 1,930,000',
                           ratio: '22.0%',
                           inventoryStyle: 'trade ready',
                           inventoryTag: 'Premium',
                           inventoryDate: 'Updated today',
                           inventoryItems: [
                              { label: 'Korean beef', progress: 78, status: 'enough' },
                              { label: 'Vegetables', progress: 72, status: 'in general' },
                              { label: 'Seafood', progress: 65, status: 'in general' },
                              { label: 'Seasoning', progress: 70, status: 'enough' }
                           ]
                        },
                        {
                           key: 'bgc',
                           name: 'BGC Branch',
                           accentClass: 'branch-bgc',
                           sales: '₱ 9,940,000',
                           delta: '+8.7%',
                           deltaClass: 'admin-badge-positive',
                           personnel: '₱ 1,920,000',
                           ratio: '19.3%',
                           inventoryStyle: 'good quality',
                           inventoryTag: 'Growth',
                           inventoryDate: 'Updated today',
                           inventoryItems: [
                              { label: 'Korean beef', progress: 83, status: 'enough' },
                              { label: 'Vegetables', progress: 75, status: 'in general' },
                              { label: 'Seafood', progress: 69, status: 'enough' },
                              { label: 'Seasoning', progress: 82, status: 'enough' }
                           ]
                        }
                     ];
                  %>
                  <div class="row admin-dashboard-section mt-4 g-3">
                     <div class="col-12">
                        <div class="row row-cols-1 row-cols-md-3 g-3">
                           <% adminBranches.forEach(branch => { %>
                              <div class="col">
                                 <div class="card admin-branch-card <%= branch.accentClass %> h-100">
                                    <div class="card-body">
                                       <div class="d-flex justify-content-between align-items-start mb-2">
                                          <h5 class="card-title mb-1"><%= branch.name %></h5>
                                          <span class="text-muted small"><%= branch.inventoryTag %></span>
                                       </div>
                                       <div class="fs-4 fw-bold mb-1"><%= branch.sales %></div>
                                       <div class="d-flex align-items-center gap-2 mb-1">
                                          <span class="badge admin-badge <%= branch.deltaClass %>"><%= branch.delta %></span>
                                          <small class="text-muted">vs Last Month</small>
                                       </div>
                                       <p class="mb-0 text-muted small">Personnel expense: <strong><%= branch.personnel %></strong></p>
                                       <p class="mb-0 text-muted small">Ratio: <strong><%= branch.ratio %></strong></p>
                                       <div class="inventory-status mt-3">
                                          <span class="text-muted small">Inventory status:</span>
                                          <span class="fw-semibold ms-1"><%= branch.inventoryStyle %></span>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           <% }) %>
                        </div>
                     </div>
                     <div class="col-12">
                        <div class="row g-3">
                           <div class="col-lg-7">
                              <div class="card admin-chart-card h-100">
                                 <div class="card-header d-flex justify-content-between align-items-center">
                                    <div>
                                       <h6 class="mb-0">real-time sales</h6>
                                       <small class="text-muted">Store sales trend by hour</small>
                                    </div>
                                    <span class="text-muted small">static preview</span>
                                 </div>
                                 <div class="card-body">
                                    <div id="admin-sales-trend" style="min-height: 260px;"></div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-lg-5">
                              <div class="card admin-chart-card h-100">
                                 <div class="card-header d-flex justify-content-between align-items-center">
                                    <div>
                                       <h6 class="mb-0">Cost analysis</h6>
                                       <small class="text-muted">Cost composition by store</small>
                                    </div>
                                    <span class="text-muted small">static preview</span>
                                 </div>
                                 <div class="card-body">
                                    <div id="admin-cost-analysis" style="min-height: 260px;"></div>
                                    <div class="d-flex justify-content-between mt-3 small text-muted admin-legend">
                                       <span><i class="fas fa-square text-primary"></i> Mainbranch</span>
                                       <span><i class="fas fa-square text-info"></i> Makati</span>
                                       <span><i class="fas fa-square text-warning"></i> BGC</span>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="col-12">
                        <div class="row row-cols-1 row-cols-md-3 g-3">
                           <% adminBranches.forEach(branch => { %>
                              <div class="col">
                                 <div class="card admin-inventory-card <%= branch.accentClass %> h-100">
                                    <div class="card-body">
                                       <div class="d-flex justify-content-between align-items-center mb-2">
                                          <h6 class="mb-0"><%= branch.name %> inventory</h6>
                                          <span class="text-muted small"><%= branch.inventoryDate %></span>
                                       </div>
                                       <% branch.inventoryItems.forEach(item => { %>
                                          <div class="inventory-item mb-3">
                                             <div class="d-flex justify-content-between mb-1">
                                                <small class="text-muted"><%= item.label %></small>
                                                <small class="fw-semibold text-capitalize"><%= item.status %></small>
                                             </div>
                                             <div class="progress admin-progress">
                                                <div class="progress-bar admin-progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" data-progress="<%= item.progress %>"></div>
                                             </div>
                                          </div>
                                       <% }) %>
                                    </div>
                                 </div>
                              </div>
                           <% }) %>
                        </div>
                     </div>
                  </div>
                  <% } %>
                  <style>
                     .admin-dashboard-section {
                        margin-top: 1rem;
                     }

                     .admin-branch-card,
                     .admin-chart-card,
                     .admin-inventory-card {
                        border: 1px solid rgba(0, 0, 0, 0.05);
                        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
                     }

                     .admin-branch-card {
                        background: linear-gradient(135deg, #ffffff, #f8fafc);
                     }

                     .admin-branch-card.branch-main {
                        border-top: 4px solid #2d6ce0;
                        background: linear-gradient(135deg, #ffffff, #eef2ff);
                     }

                     .admin-branch-card.branch-makati {
                        border-top: 4px solid #20c997;
                        background: linear-gradient(135deg, #ffffff, #f0fdfa);
                     }

                     .admin-branch-card.branch-bgc {
                        border-top: 4px solid #f97316;
                        background: linear-gradient(135deg, #ffffff, #fff4e6);
                     }

                     .admin-inventory-card.branch-main {
                        background: linear-gradient(135deg, #ffffff, #eef2ff);
                        border-color: rgba(45, 108, 224, 0.35);
                     }

                     .admin-inventory-card.branch-makati {
                        background: linear-gradient(135deg, #ffffff, #e0fdf4);
                        border-color: rgba(32, 201, 151, 0.35);
                     }

                     .admin-inventory-card.branch-bgc {
                        background: linear-gradient(135deg, #ffffff, #fff3e0);
                        border-color: rgba(249, 115, 22, 0.35);
                     }

                     .admin-branch-card .card-title {
                        color: #1f2937;
                     }

                     .admin-branch-card.branch-main .admin-badge,
                     .admin-branch-card.branch-main .inventory-status span {
                        color: #0d6efd;
                     }

                     .admin-branch-card.branch-makati .admin-badge,
                     .admin-branch-card.branch-makati .inventory-status span {
                        color: #20c997;
                     }

                     .admin-branch-card.branch-bgc .admin-badge,
                     .admin-branch-card.branch-bgc .inventory-status span {
                        color: #f97316;
                     }

                     .admin-chart-card .card-header,
                     .admin-chart-card .card-body {
                        padding-bottom: 0.75rem;
                        padding-top: 0.75rem;
                     }

                     .admin-inventory-card {
                        min-height: 260px;
                        background: #fff;
                        border: 1px solid rgba(0, 0, 0, 0.04);
                     }

                     .admin-badge {
                        border-radius: 999px;
                        font-size: 0.7rem;
                        padding: 0.18rem 0.65rem;
                     }

                     .admin-badge-positive {
                        background-color: rgba(25, 135, 84, 0.12);
                        color: var(--bs-success);
                     }

                     .admin-legend span {
                        display: flex;
                        align-items: center;
                        gap: 0.35rem;
                     }

                     .admin-progress {
                        height: 6px;
                        border-radius: 999px;
                        background-color: rgba(108, 117, 125, 0.15);
                     }

                     .admin-progress .progress-bar {
                        background: linear-gradient(135deg, #0d6efd, #6610f2);
                     }

                     .admin-inventory-card .inventory-item small {
                        color: #6b7280;
                     }

                     .admin-inventory-card.branch-main .progress-bar {
                        background: linear-gradient(135deg, #2d6ce0, #4f46e5);
                     }

                     .admin-inventory-card.branch-makati .progress-bar {
                        background: linear-gradient(135deg, #20c997, #0d9488);
                     }

                     .admin-inventory-card.branch-bgc .progress-bar {
                        background: linear-gradient(135deg, #f97316, #ea580c);
                     }

                     .admin-progress-bar {
                        width: 0;
                        transition: width 0.6s ease;
                     }

                     @media (max-width: 768px) {
                        .admin-legend {
                           flex-direction: column;
                           gap: 0.25rem;
                        }
                     }
                  </style>
               </form>
               <!-- END CARDS -->
                  <!-- JUNKET BALANC -->
                  <!-- <div class="col-md-12 col-lg-12">
                     <div class="row">

                        <div class="col-lg-4">
                           <div class="card">
                              <div class="card-body">
                                 <h5 class="mb-3">
                                    <%= __('dashboard.house_balance') %>
                                 </h5>
                                 <h2 class="counter mb-2" id="cash-balance-value">₱ 0</h2>





                                 <a href="#" class="mt-4 btn btn-primary d-block rounded " data-bs-toggle="modal"
                                    data-bs-target="#modal-new-capital">
                                    <%= __('dashboard.history') %>
                                 </a>
                                 <div class="mt-3">
                                    <div class="pb-3">
                                       <div
                                          class="d-flex align-items-center justify-content-between mb-2 cursor-pointer"
                                          data-bs-target="#modal-Cash-In" data-bs-toggle="modal">
                                          <p class="mt-0">
                                             <%= __('dashboard.cash_in') %>
                                          </p>
                                          <h6 id="cash-in-total">₱0</h6>
                                       </div>
                                       <div class="progress bg-info-subtle shadow-none w-100 mb-1" style="height: 10px">
                                          <div class="progress-bar bg-info" data-toggle="progress-bar"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100"></div>
                                       </div>
                                    </div>
                                    <div class="pb-3">
                                       <div
                                          class="d-flex align-items-center justify-content-between mb-2 cursor-pointer"
                                          data-bs-target="#modal-Transaction" data-bs-toggle="modal">
                                          <p class="mb-0">
                                             <%= __('dashboard.chips_transaction') %>
                                          </p>
                                          <h6 id="chips-transaction-total">₱0</h6>
                                       </div>
                                       <div class="progress bg-success-subtle shadow-none w-100 mb-1"
                                          style="height: 10px">
                                          <div class="progress-bar bg-success" data-toggle="progress-bar"
                                             role="progressbar" aria-valuenow="80" aria-valuemin="0"
                                             aria-valuemax="100">
                                          </div>
                                       </div>
                                    </div>
                                    <div class="pb-3">
                                       <div
                                          class="d-flex align-items-center justify-content-between mb-2 cursor-pointer"
                                          data-bs-target="#modal-Expenses" data-bs-toggle="modal">
                                          <p class="mb-0">
                                             <%= __('dashboard.expenses') %>
                                          </p>
                                          <h6 id="junket-expense-total">₱0</h6>
                                       </div>
                                       <div class="progress bg-primary-subtle shadow-none w-100 " style="height: 10px">
                                          <div class="progress-bar bg-primary" data-toggle="progress-bar"
                                             role="progressbar" aria-valuenow="55" aria-valuemin="0"
                                             aria-valuemax="100">
                                          </div>
                                       </div>
                                    </div>


                                 </div>
                              </div>

                           </div>

                        </div> 

                        <div class="col-lg-4">


                           <div class="card" data-aos="fade-up" data-aos-delay="500">
                              <div class="text-center card-body d-flex justify-content-around">
                                 <div>
                                    <h6 class="mb-2 ">
                                       <%= __('dashboard.expenses') %>
                                    </h6>
                                    <h4 class="counter mb-0" id="expense">₱ 0
                                          <input type="hidden" name="EXPENSE_HISTORY" value="0">
                                    </h4>

                                 </div>
                                 <hr class="hr-vertial">
                                 <div>
                                    <a href="/house_expense" target="_blank" class="mt-4 btn btn-primary-subtle
                            d-block rounded">
                                       <%= __('dashboard.details') %>
                                    </a>
                                 </div>
                              </div>
                           </div>



                           <div class="card" data-aos="fade-up" data-aos-delay="500">
                              <div class="text-center card-body d-flex justify-content-around">
                                 <div>
                                    <h6 class="mb-2 ">
                                       <%= __('dashboard.guest_balance') %>

                                    </h6>
                                    <h4 class="counter ">₱ 0

                                          <span class="ms-2 plus-spacing">
                                             <a href="#" class="btn btn-sm btn-primary-subtle" data-bs-toggle="modal"
                                                data-bs-target="#modal-guestAccount">
                                                <%= __('dashboard.details') %>
                                             </a></span>
                                    </h4>

                                 </div>

                                 <div class="vr"></div>

                                 <div>
                                    <h6 class="mb-2 ">
                                       <%= __('dashboard.accounts') %>

                                    </h6>
                                    <h4>0
                                          <a href="/agency" target="_blank">
                                             <span class="ms-2 plus-spacing">
                                                <i class="fa-solid fa-eye plus-icon tooltip-hover"
                                                   data-bs-toggle="tooltip" data-bs-placement="top" title="Details"></i>
                                             </span>
                                          </a>
                                    </h4>

                                 </div>
                              </div>
                           </div>



                           <div class="card" data-aos="fade-up" data-aos-delay="500">
                              <div class="text-center card-body d-flex justify-content-around">
                                 <div>
                                    <h6 class="mb-2 ">
                                       <%= __('dashboard.guest_credit') %>
                                    </h6>
                                    <h4 class="counter mb-0">₱ 0</h4>

                                 </div>
                                 <hr class="hr-vertial">
                                 <div>
                                    <a href="#" class="mt-4 btn btn-primary-subtle
                               d-block rounded" data-bs-toggle="modal" data-bs-target="#modal-new-marker">
                                       <%= __('dashboard.details') %>
                                    </a>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="col-lg-4">
                           <div class="card" data-aos="fade-up" data-aos-delay="600">
                              <div class="card-header">
                               
                                 <div class="d-flex justify-content-between align-items-center ">
                                  
                                    <div>
                                       <h6 class="mb-2">
                                          <%= __('dashboard.win_loss') %>
                                       </h6>
                                       <div class="d-flex align-items-center">
                                          <h4 class="card-title counter m-0" id="winlossweekly">
                                             ₱ <span class="text-muted">Loading...</span>
                                          </h4>
                                          <span id="winloss-trend" class="badge trend-indicator"
                                             style="margin-left: 10px;"></span>
                                       </div>


                                       <div id="winloss-comparison " class="mt-1 "></div>
                                       <input type="hidden" name="WINLOSS_HISTORY1" value="0">
                                    </div>

                                 
                                    <div class="dropdown">
                                       <a href="#" class="text-gray dropdown-toggle" id="dropdownMenuButton3"
                                          data-bs-toggle="dropdown" aria-expanded="false">
                                          <%= __('dashboard.Weekly') %>
                                       </a>
                                       <ul class="dropdown-menu dropdown-menu-end custom-dropdown-menu-end"
                                          aria-labelledby="dropdownMenuButton3" id="winloss-filter">
                                          <li><a class="dropdown-item" href="#" data-range="week">
                                                <%= __('dashboard.Weekly') %>
                                             </a></li>
                                          <li><a class="dropdown-item" href="#" data-range="month">
                                                <%= __('dashboard.Monthly') %>
                                             </a></li>
                                          <li><a class="dropdown-item" href="#" data-range="year">
                                                <%= __('dashboard.Yearly') %>
                                             </a></li>
                                       </ul>
                                    </div>
                                 </div>




                              </div>

                              <div class="card-body">
                                 <div id="d-activity" class="d-activity"></div>
                                 <div class="d-flex align-items-center justify-content-center mt-2">

                                  
                                    <button id="prev-week-btn" type="button" class="circle-btn me-2"
                                       title="Previous Week">
                                       <i class="fas fa-chevron-left"></i>
                                    </button>

                                   
                                    <div class="d-flex flex-column align-items-center text-center">
                                       <div id="week-label">This Week</div>
                                       <span id="week-date-range" class="text-muted small"></span>
                                    </div>

                                   
                                    <button id="next-week-btn" type="button" class="circle-btn ms-2 d-none"
                                       title="This Week">
                                       <i class="fas fa-chevron-right"></i>
                                    </button>
                                 </div>
                              </div>
                           </div>
                        </div>

                     -->






                        <!-- ON GAME -->
                        <!-- <div class="col-lg-4">
                           <div class="overflow-hidden card" data-aos="fade-up" data-aos-delay="600">
                              <div class="flex-wrap card-header d-flex justify-content-between">
                                 <div class="header-title">
                                    <h4 class="mb-2 card-title">
                                       <%= __('dashboard.on_game') %>
                                    </h4>
                                    <p class="mb-0">

                                    </p>
                                 </div>
                              </div>
                              <div class="p-0 card-body">
                                 <div class="mt-4 table-responsive">
                                    <table id="on_game-tbl" class="table mb-0 table-striped" role="grid">
                                       <thead>
                                          <tr>
                                             <th>
                                                <%= __('dashboard.game_number') %>
                                             </th>
                                             <th>
                                                <%= __('dashboard.guest') %>
                                             </th>
                                             <th>
                                                <%= __('dashboard.game_type') %>
                                             </th>
                                             <th>
                                                <%= __('dashboard.total_buyin') %>
                                             </th>
                                             
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr>
                                             <td></td>
                                             <td></td>
                                             <td></td>
                                             <td></td>
                                          
                                          </tr>
                                       </tbody>
                                       <tfoot>
                                          <tr>
                                             <td colspan="4" class="text-center">
                                                <a href="/game_list" target="_blank"
                                                   class="btn btn-primary-subtle btn-lg w-100">
                                                   <%= __('dashboard.show_details') %>
                                                </a>
                                             </td>
                                          </tr>
                                       </tfoot>
                                    </table>
                                 </div>
                              </div>
                           </div>
                        </div> -->
                        <!-- END ON GAME -->
                        <!-- <div class="col-lg-4">
                           <div class="card" data-aos="fade-up" data-aos-delay="900">
                              <div class="flex-wrap card-header d-flex justify-content-between">
                                 <div class="header-title">
                                    <h4 class="card-title">
                                       <%= __('dashboard.rolling') %>
                                    </h4>
                                 </div>
                              </div>
                              <div class="card-body">
                                 <div class="flex-wrap d-flex align-items-center justify-content-between">

                                   
                                    <div id="myChart" class="col-md-12 col-lg-12 myChart"
                                       data-totalrolling="0"
                                       data-houserolling="0">
                                       <span id="totalrolling"></span>
                                       <span id="totalhouserolling"></span>
                                    </div>
                                    <input type="hidden" name="HOUSE_ROLLING_HISTORY" value="0">
                                    <input type="hidden" name="TOTAL_ROLLING_HISTORY" value="0">



                                 </div>
                              </div>
                           </div>
                        </div>

                        <div class="col-lg-4">
                           <div class="card" data-aos="fade-up" data-aos-delay="600">
                              <div class="flex-wrap card-header d-flex justify-content-between">
                                 <div class="header-title">
                                    <h4 class="mb-2 card-title">
                                       <%= __('dashboard.activity_overview') %>
                                    </h4>
                                    <p class="mb-0">
                                       <svg class="me-2 icon-24" width="24" height="24" viewBox="0 0 24 24">
                                          <path fill="#17904b"
                                             d="M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z" />
                                       </svg>
                                       <%= __('dashboard.latest_activities') %>
                                    </p>
                                 </div>
                              </div>
                              <div class="card-body" id="activity-overview">
                                 <p class='text-muted'>
                                    <%= __('dashboard.loading_activity_logs') %>
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div> -->

                  <!-- END CARDS -->
            </div>

            </form>
            <%- include('partials/footer') %>




                                                   <script src="/assets/js/functions/reset.js"></script>


                                                   <!-- <script>
                        document.addEventListener('DOMContentLoaded', function () {
                           // Retrieve user permissions from the HTML element
                           var userPermissions = parseInt(document.getElementById('user-role').getAttribute('data-permissions'), 10);

                           document.getElementById('cash-balance-link').addEventListener('click', function (event) {
                              // Use the permissions to determine if the user can access the feature
                              if (userPermissions !== 1 && userPermissions !== 2) { // 1 indicates admin, 2 indicates manager
                                 event.preventDefault(); // Prevent the link's default action (opening the modal)

                                 Swal.fire({
                                    icon: 'warning',
                                    title: 'No Permission',
                                    text: 'You do not have permission to access this feature.',
                                    confirmButtonText: 'OK',
                                    confirmButtonColor: '#6f9c40'
                                 });
                              } else {
                                 // If the user is a manager, manually open the modal
                                 var modal = new bootstrap.Modal(document.getElementById('modal-new-capital'));
                                 modal.show();
                              }
                           });
                        });
                     </script> -->


                                                   <script>
                                                      // Kim's Brothers static dashboard behaviours
                                                      (function () {
                                                         if (!window.ApexCharts) return;
                                                         if (typeof isKimsBrothersDashboard === 'undefined' && !document.getElementById('kb-sales-chart')) {
                                                            return;
                                                         }

                                                         const kbData = {
                                                            labels: [
                                                               '29 Dec', '30 Dec', '31 Dec',
                                                               '01 Jan', '02 Jan', '03 Jan', '04 Jan',
                                                               '05 Jan', '06 Jan', '07 Jan', '08 Jan', '09 Jan', '10 Jan',
                                                               '11 Jan', '12 Jan', '13 Jan', '14 Jan', '15 Jan',
                                                               '16 Jan', '17 Jan', '18 Jan', '19 Jan', '20 Jan',
                                                               '21 Jan', '22 Jan', '23 Jan', '24 Jan', '25 Jan', '26 Jan', '27 Jan'
                                                            ],
                                                            sales: [
                                                               205000, 207000, 65000,
                                                               0, 150000, 212000, 215000,
                                                               135000, 140000, 168000, 178000, 145000, 220000,
                                                               205000, 130000, 145000, 170000, 220000,
                                                               180000, 195000, 205000, 150000, 160000,
                                                               175000, 210000, 245000, 230000, 190000, 62000
                                                            ]
                                                         };

                                                         const chartEl = document.getElementById('kb-sales-chart');
                                                         if (!chartEl) return;

                                                         const baseOptions = {
                                                            series: [{
                                                               name: 'Total sales',
                                                               data: kbData.sales
                                                            }],
                                                            chart: {
                                                               type: 'bar',
                                                               height: 280,
                                                               toolbar: { show: false },
                                                               zoom: { enabled: false },
                                                               fontFamily: '"Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif'
                                                            },
                                                            plotOptions: {
                                                               bar: {
                                                                  columnWidth: '55%',
                                                                  borderRadius: 6,
                                                                  borderRadiusApplication: 'end',
                                                                  distributed: false
                                                               }
                                                            },
                                                            stroke: {
                                                               show: true,
                                                               width: 2,
                                                               colors: ['#ffffff']
                                                            },
                                                            dataLabels: { enabled: false },
                                                            colors: ['#22c55e'],
                                                            fill: {
                                                               type: 'gradient',
                                                               gradient: {
                                                                  shade: 'light',
                                                                  type: 'vertical',
                                                                  shadeIntensity: 0.25,
                                                                  gradientToColors: ['#16a34a'],
                                                                  opacityFrom: 0.9,
                                                                  opacityTo: 0.95,
                                                                  stops: [0, 40, 100]
                                                               }
                                                            },
                                                            grid: {
                                                               borderColor: '#e5e7eb',
                                                               strokeDashArray: 4,
                                                               yaxis: { lines: { show: true } },
                                                               xaxis: { lines: { show: false } }
                                                            },
                                                            xaxis: {
                                                               categories: kbData.labels,
                                                               axisBorder: { show: false },
                                                               axisTicks: { show: false },
                                                               labels: {
                                                                  rotate: -45,
                                                                  style: {
                                                                     colors: '#9ca3af',
                                                                     fontSize: '11px'
                                                                  }
                                                               }
                                                            },
                                                            yaxis: {
                                                               labels: {
                                                                  style: {
                                                                     colors: '#9ca3af',
                                                                     fontSize: '11px'
                                                                  },
                                                                  formatter: function (val) {
                                                                     return '₱' + Number(val).toLocaleString();
                                                                  }
                                                               }
                                                            },
                                                            tooltip: {
                                                               theme: 'light',
                                                               y: {
                                                                  formatter: function (val) {
                                                                     return '₱' + Number(val).toLocaleString();
                                                                  }
                                                               }
                                                            }
                                                         };

                                                         let kbChart = new ApexCharts(chartEl, baseOptions);
                                                         kbChart.render();

                                                         const tableBody = document.getElementById('kb-sales-table-body');
                                                         if (tableBody) {
                                                            const rows = [
                                                               {
                                                                  date: '27 Jan 2026',
                                                                  totalSales: 62330,
                                                                  refund: 0,
                                                                  discount: 0,
                                                                  netSales: 62330,
                                                                  unitPrice: 0,
                                                                  grossProfit: 62330
                                                               },
                                                               {
                                                                  date: '26 Jan 2026',
                                                                  totalSales: 194760,
                                                                  refund: 0,
                                                                  discount: 648,
                                                                  netSales: 194112,
                                                                  unitPrice: 0,
                                                                  grossProfit: 194112
                                                               }
                                                            ];

                                                            tableBody.innerHTML = rows.map(r => `
                                                               <tr>
                                                                  <td>${r.date}</td>
                                                                  <td class="text-end">₱${r.totalSales.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</td>
                                                                  <td class="text-end">₱${r.refund.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</td>
                                                                  <td class="text-end">₱${r.discount.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</td>
                                                                  <td class="text-end">₱${r.netSales.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</td>
                                                                  <td class="text-end">₱${r.unitPrice.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</td>
                                                                  <td class="text-end">₱${r.grossProfit.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</td>
                                                               </tr>
                                                            `).join('');
                                                         }

                                                         const chartTypeSelect = document.getElementById('kb-chart-type');
                                                         if (chartTypeSelect) {
                                                            chartTypeSelect.addEventListener('change', function () {
                                                               const isLine = this.value === 'line';

                                                               if (isLine) {
                                                                  kbChart.updateOptions({
                                                                     chart: { type: 'line' },
                                                                     stroke: {
                                                                        curve: 'smooth',
                                                                        width: 3.2,
                                                                        colors: ['#16a34a']
                                                                     },
                                                                     markers: {
                                                                        size: 3,
                                                                        strokeWidth: 2,
                                                                        strokeColors: '#ffffff',
                                                                        colors: ['#16a34a'],
                                                                        hover: {
                                                                           sizeOffset: 1.5
                                                                        }
                                                                     },
                                                                     // Solid line, walang area fill para super klaro
                                                                     fill: {
                                                                        type: 'solid',
                                                                        opacity: 1
                                                                     },
                                                                     plotOptions: { bar: { columnWidth: '55%', borderRadius: 0 } }
                                                                  }, false, true);
                                                               } else {
                                                                  kbChart.updateOptions({
                                                                     chart: { type: 'bar' },
                                                                     stroke: baseOptions.stroke,
                                                                     markers: { size: 0 },
                                                                     fill: baseOptions.fill,
                                                                     plotOptions: baseOptions.plotOptions
                                                                  }, false, true);
                                                               }
                                                            });
                                                         }
                                                         // DATE RANGE PICKER FOR KIM'S BROTHERS (tries DateRangePicker, falls back to Flatpickr)
                                                         (function () {
                                                            const dateBtnEl = document.getElementById('kb-date-range-button');
                                                            const dateLabelEl = document.getElementById('kb-date-range-label');
                                                            const dateInputEl = document.getElementById('kb-date-range-input');

                                                            if (!dateBtnEl || !dateLabelEl) return;

                                                            // Shared default range
                                                            const defaultStart = '2025-12-29';
                                                            const defaultEnd = '2026-01-27';

                                                            // --- Try DateRangePicker first (with presets) ---
                                                            const $ = window.jQuery || window.$;
                                                            const hasDR =
                                                               $ && $.fn && typeof $.fn.daterangepicker === 'function' && window.moment;

                                                            function setLabelText(startText, endText) {
                                                               dateLabelEl.textContent = `${startText} - ${endText}`;
                                                            }

                                                            if (hasDR) {
                                                               const start = moment(defaultStart, 'YYYY-MM-DD');
                                                               const end = moment(defaultEnd, 'YYYY-MM-DD');

                                                               $(dateBtnEl).daterangepicker(
                                                                  {
                                                                     startDate: start,
                                                                     endDate: end,
                                                                     opens: 'left',
                                                                     ranges: {
                                                                        'today': [moment(), moment()],
                                                                        'yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                                                                        'This week': [moment().startOf('week'), moment().endOf('week')],
                                                                        'Last week': [
                                                                           moment().subtract(1, 'week').startOf('week'),
                                                                           moment().subtract(1, 'week').endOf('week')
                                                                        ],
                                                                        'This month': [moment().startOf('month'), moment().endOf('month')],
                                                                        'Last month': [
                                                                           moment().subtract(1, 'month').startOf('month'),
                                                                           moment().subtract(1, 'month').endOf('month')
                                                                        ],
                                                                        'Last 7 days': [moment().subtract(6, 'days'), moment()],
                                                                        'Last 30 days': [moment().subtract(29, 'days'), moment()]
                                                                     },
                                                                     locale: {
                                                                        format: 'DD MMM YYYY',
                                                                        applyLabel: 'COMPLETE!',
                                                                        cancelLabel: 'CANCELLATION'
                                                                     }
                                                                  },
                                                                  function (startDate, endDate) {
                                                                     setLabelText(
                                                                        startDate.format('DD MMM YYYY'),
                                                                        endDate.format('DD MMM YYYY')
                                                                     );
                                                                  }
                                                               );

                                                               // initial text
                                                               setLabelText(start.format('DD MMM YYYY'), end.format('DD MMM YYYY'));
                                                               return; // done
                                                            }

                                                            // --- Fallback: Flatpickr range picker ---
                                                            if (window.flatpickr && dateInputEl) {
                                                               const fp = flatpickr(dateInputEl, {
                                                                  mode: 'range',
                                                                  defaultDate: [defaultStart, defaultEnd],
                                                                  dateFormat: 'd M Y',
                                                                  appendTo: dateBtnEl.parentNode,
                                                                  positionElement: dateBtnEl,
                                                                  onClose: function (selectedDates) {
                                                                     if (selectedDates.length === 2) {
                                                                        const opts = {
                                                                           day: '2-digit',
                                                                           month: 'short',
                                                                           year: 'numeric'
                                                                        };
                                                                        const startText = selectedDates[0].toLocaleDateString('en-US', opts);
                                                                        const endText = selectedDates[1].toLocaleDateString('en-US', opts);
                                                                        setLabelText(startText, endText);
                                                                     }
                                                                  }
                                                               });

                                                               dateBtnEl.addEventListener('click', function () {
                                                                  fp.open();
                                                               });
                                                            }
                                                         })();

                                                         // TIME FILTER DROPDOWN (All day long / Custom period)
                                                         (function () {
                                                            const btn = document.getElementById('kb-time-filter-btn');
                                                            const menu = document.getElementById('kb-time-menu');
                                                            const label = document.getElementById('kb-time-filter-label');
                                                            const customRow = document.getElementById('kb-time-custom-row');
                                                            const startSelect = document.getElementById('kb-time-start');
                                                            const endSelect = document.getElementById('kb-time-end');
                                                            if (!btn || !menu || !label || !customRow || !startSelect || !endSelect) return;

                                                            // Populate time options (00:00 - 23:00)
                                                            const times = [];
                                                            for (let h = 0; h < 24; h++) {
                                                               const t = String(h).padStart(2, '0') + ':00';
                                                               times.push(t);
                                                            }
                                                            function appendOptions(selectEl) {
                                                               selectEl.innerHTML = '';
                                                               times.forEach((t) => {
                                                                  const opt = document.createElement('option');
                                                                  opt.value = t;
                                                                  opt.textContent = t;
                                                                  selectEl.appendChild(opt);
                                                               });
                                                            }
                                                            appendOptions(startSelect);
                                                            appendOptions(endSelect);
                                                            startSelect.value = '00:00';
                                                            endSelect.value = '23:00';

                                                            let mode = 'all_day';

                                                            btn.addEventListener('click', function (e) {
                                                               e.stopPropagation();
                                                               menu.classList.toggle('show');
                                                            });

                                                            document.addEventListener('click', function (e) {
                                                               if (!menu.contains(e.target) && !btn.contains(e.target)) {
                                                                  menu.classList.remove('show');
                                                               }
                                                            });

                                                            function updateLabel() {
                                                               if (mode === 'all_day') {
                                                                  label.textContent = 'All day long';
                                                               } else {
                                                                  label.textContent = `${startSelect.value} - ${endSelect.value}`;
                                                               }
                                                            }

                                                            const modeRadios = menu.querySelectorAll('input[name="kb-time-mode"]');
                                                            modeRadios.forEach((radio) => {
                                                               radio.addEventListener('change', function () {
                                                                  mode = this.value;
                                                                  if (mode === 'custom') {
                                                                     customRow.classList.remove('d-none');
                                                                  } else {
                                                                     customRow.classList.add('d-none');
                                                                  }
                                                                  updateLabel();
                                                               });
                                                            });

                                                            startSelect.addEventListener('change', updateLabel);
                                                            endSelect.addEventListener('change', updateLabel);
                                                         })();
                                                      })();

                                                      // ─────────────────────────────────────────────────────────────────────────────
                                                      // ACTIVITY LOGS SCRIPT
                                                      // ─────────────────────────────────────────────────────────────────────────────

                                                      function formatDate(dateString) {
                                                         const opts = { month: "short", day: "numeric", hour: "2-digit", minute: "2-digit" };
                                                         return new Date(dateString).toLocaleDateString("en-US", opts);
                                                      }

                                                      function highlightName(text) {
                                                         return text.replace(/₱([\d,]+)(\.\d{2})?/g, '<strong>₱$1</strong>');
                                                      }

                                                      function getClickableText(fullText, linkUrl, ledgerId, guest = '', acctName = '') {
                                                         const prefixes = ["New Booking", "Transaction", "Junket Expense"];
                                                         const pfx = prefixes.find(p => fullText.startsWith(p));
                                                         if (!pfx) {
                                                            return `<span style="color:grey;">${highlightName(fullText)}</span>`;
                                                         }

                                                         const rem = fullText.slice(pfx.length);
                                                         const highlightedRem = highlightName(rem);

                                                         if (ledgerId && linkUrl !== '#') {
                                                            return `
      <a href="${linkUrl}"
         data-ledger-id="${ledgerId}"
         data-guest="${guest}"
         data-account-name="${acctName}"
         style="color:grey; text-decoration:none;">
        ${pfx}<span style="color:grey;">${highlightedRem}</span>
      </a>`;
                                                         } else {
                                                            return `<span style="color:grey;">${pfx}<span>${highlightedRem}</span></span>`;
                                                         }
                                                      }

                                                      document.addEventListener("DOMContentLoaded", () => {
                                                         fetch('/activity_logs')
                                                            .then(r => r.json())
                                                            .then(data => {
                                                               const container = document.getElementById("activity-overview");
                                                               if (!container) return;
                                                               container.innerHTML = data.length
                                                                  ? data.map(log => {
                                                                     let url = "#";
                                                                     if (log.related_id) {
                                                                        if (["transaction", "added", "edited", "deleted"].includes(log.action_type)) {
                                                                           url = `/accounts?id=${log.related_id}`;
                                                                        } else if (["expense_added", "expense_edited"].includes(log.action_type)) {
                                                                           url = `/junket/house_expense?id=${log.related_id}`;
                                                                        } else if (["user_added", "user_edited"].includes(log.action_type)) {
                                                                           url = `/user_management?id=${log.related_id}`;
                                                                        } else if (["role_added", "role_edited"].includes(log.action_type)) {
                                                                           url = `/userRoles?id=${log.related_id}`;
                                                                        } else if (["booking_added"].includes(log.action_type)) {
                                                                           url = `/booking?id=${log.related_id}`;
                                                                        }
                                                                     }

                                                                     let displayName = log.name;
                                                                     if (log.action_type === "transaction" && log.guest_name && log.account_name) {
                                                                        displayName = displayName
                                                                           .replace(`Deposit - ${log.guest_name}`, `Deposit - ${log.guest_name} Deposit to Account ${log.account_name}`)
                                                                           .replace(`Withdraw - ${log.guest_name}`, `Withdraw - ${log.guest_name} Withdraw from Account ${log.account_name}`);
                                                                     }

                                                                     return `
              <div class="mb-2 d-flex profile-media align-items-top">
                <div class="mt-1 profile-dots-pills border-primary"></div>
                <div class="ms-4">
                  <h6 class="mb-1" style="color:grey;">
                    ${getClickableText(displayName, url, log.related_id, log.guest_name, log.account_name)}
                  </h6>
                  <span style="color:grey;">${formatDate(log.action_time)}</span>
                </div>
              </div>`;
                                                                  }).join("")
                                                                  : "<p class='text-muted' style='color:grey;'>No recent activity.</p>";
                                                            })
                                                            .catch(console.error);
                                                      });

                                                      // click handler para sa 'Transaction' links
                                                      const activityOverview = document.getElementById("activity-overview");
                                                      if (activityOverview) {
                                                         activityOverview.addEventListener("click", e => {
                                                            const a = e.target.closest("a[data-ledger-id]");
                                                            if (!a || !a.innerText.trim().startsWith("Transaction")) return;
                                                            e.preventDefault();

                                                            const ledgerId = a.getAttribute("data-ledger-id");
                                                            const guestName = a.getAttribute("data-guest");
                                                            const acctName = a.getAttribute("data-account-name");
                                                            console.log("Activity click → ledgerId:", ledgerId, "guest:", guestName, "acctName:", acctName);

                                                            account_details_v2(ledgerId, guestName, acctName);
                                                         });
                                                      }

                                                      // END OF ACTIVITY LOGS SCRIPT


                                                      let currentWeekOffset = 0;

                                                      function loadWinloss(range, label, offset = 0) {
                                                         currentWeekOffset = offset;

                                                         // Show loading state (with null checks)
                                                         const winlossEl = document.getElementById('winlossweekly');
                                                         if (winlossEl) {
                                                            winlossEl.innerHTML = '<span class="text-muted"><i class="fas fa-spinner fa-spin"></i> Loading...</span>';
                                                         }
                                                         const comparisonEl = document.getElementById('winloss-comparison');
                                                         if (comparisonEl) {
                                                            comparisonEl.innerHTML = '';
                                                         }

                                                         // Update week label
                                                         if (range === 'week') {
                                                            const labelText = offset === 0 ? 'This Week' : `Week -${Math.abs(offset)}`;
                                                            const weekLabelEl = document.getElementById('week-label');
                                                            if (weekLabelEl) {
                                                               weekLabelEl.textContent = labelText;
                                                            }

                                                            const dateRange = getDateRange(offset);
                                                            const weekDateRangeEl = document.getElementById('week-date-range');
                                                            if (weekDateRangeEl) {
                                                               weekDateRangeEl.textContent = `(${dateRange})`;
                                                            }
                                                         } else {
                                                            const weekDateRangeEl = document.getElementById('week-date-range');
                                                            if (weekDateRangeEl) {
                                                               weekDateRangeEl.textContent = '';
                                                            }
                                                         }


                                                         // Only update dropdown label if not custom offset
                                                         if (range !== 'week' || offset === 0) {
                                                            const dropdownEl = document.getElementById('dropdownMenuButton3');
                                                            if (dropdownEl) {
                                                               dropdownEl.textContent = label;
                                                            }
                                                         }

                                                         fetch(`/get_winloss?range=${range}&offset=${offset}`)
                                                            .then(res => res.json())
                                                            .then(data => {
                                                               const formatted = parseFloat(data.winloss).toLocaleString();
                                                               if (winlossEl) {
                                                                  winlossEl.innerHTML = `₱ ${formatted}`;
                                                               }
                                                               const winlossInput = document.querySelector('input[name="WINLOSS_HISTORY1"]');
                                                               if (winlossInput) {
                                                                  winlossInput.value = data.winloss;
                                                               }

                                                               // Update comparison data
                                                               if (data.percentChange !== undefined) {
                                                                  const comparisonEl = document.getElementById('winloss-comparison');
                                                                  if (comparisonEl) {
                                                                     const percentChange = data.percentChange.toFixed(1);
                                                                     const isPositive = percentChange > 0;
                                                                     const arrowIcon = isPositive ? 'fa-arrow-up' : 'fa-arrow-down';
                                                                     const colorClass = isPositive ? 'text-success' : 'text-danger';

                                                                     comparisonEl.innerHTML = `
                  <small class="${colorClass}">
                     <i class="fas ${arrowIcon}"></i> ${Math.abs(percentChange)}% vs Last Month
                  </small>
               `;
                                                                  }
                                                               }

                                                               if (data.chart && data.chart.data && Array.isArray(data.chart.data) && data.chart.labels && Array.isArray(data.chart.labels)) {
                                                                  if (typeof updateWinlossChart === 'function') {
                                                                  updateWinlossChart(data.chart);
                                                                  }
                                                               }

                                                               // Toggle arrows: only show "→" when not on current week
                                                               const nextWeekBtn = document.getElementById('next-week-btn');
                                                               if (nextWeekBtn) {
                                                                  nextWeekBtn.classList.toggle('d-none', offset === 0);
                                                               }
                                                            })
                                                            .catch(err => {
                                                               // Silent error handling for template
                                                               if (winlossEl) {
                                                                  winlossEl.innerHTML = '₱ 0';
                                                               }
                                                            });
                                                      }
                                                      function getDateRange(offset = 0) {
                                                         const today = new Date();
                                                         const day = today.getDay();
                                                         const diffToMonday = day === 0 ? -6 : 1 - day;

                                                         const start = new Date(today);
                                                         start.setDate(start.getDate() + diffToMonday + (offset * 7));

                                                         const end = new Date(start);
                                                         end.setDate(start.getDate() + 6);

                                                         const options = { month: 'short', day: 'numeric' };
                                                         return `${start.toLocaleDateString('en-US', options)} – ${end.toLocaleDateString('en-US', options)}`;
                                                      }

                                                      // Dropdown
                                                      document.querySelectorAll('#winloss-filter a.dropdown-item').forEach(item => {
                                                         item.addEventListener('click', function (e) {
                                                            e.preventDefault();
                                                            const range = this.getAttribute('data-range');
                                                            const label = this.textContent.trim();
                                                            currentWeekOffset = 0;
                                                            loadWinloss(range, label, 0);
                                                         });
                                                      });

                                                      // Arrows
                                                      const prevWeekBtn = document.getElementById('prev-week-btn');
                                                      if (prevWeekBtn) {
                                                         prevWeekBtn.addEventListener('click', () => {
                                                         currentWeekOffset--;
                                                         loadWinloss('week', `Week -${Math.abs(currentWeekOffset)}`, currentWeekOffset);
                                                      });
                                                      }
                                                      const nextWeekBtn2 = document.getElementById('next-week-btn');
                                                      if (nextWeekBtn2) {
                                                         nextWeekBtn2.addEventListener('click', () => {
                                                         currentWeekOffset = 0;
                                                         loadWinloss('week', 'This Week', 0);
                                                      });
                                                      }

                                                      // Init (only if elements exist)
                                                      window.addEventListener('DOMContentLoaded', () => {
                                                         const winlossWeeklyCheck = document.getElementById('winlossweekly');
                                                         if (winlossWeeklyCheck) {
                                                         loadWinloss('week', 'This Week', 0);
                                                         }
                                                      });






                                                      document.addEventListener('DOMContentLoaded', () => {
                                                         document.querySelectorAll('.admin-progress-bar').forEach(bar => {
                                                            const value = parseFloat(bar.getAttribute('data-progress')) || 0;
                                                            bar.style.width = `${value}%`;
                                                            bar.setAttribute('aria-valuenow', value);
                                                         });
                                                      });

                                                      // END OF WIN / LOSS
                                                   </script>





                                                   <style>
                                                      .cursor-pointer {
                                                         cursor: pointer !important;
                                                      }


                                                      #week-label {
                                                         min-width: 100px;
                                                         text-align: center;
                                                         font-weight: 500;
                                                         font-size: 14px;
                                                         line-height: 1.2;
                                                      }

                                                      #week-date-range {
                                                         font-size: 12px;
                                                         line-height: 1.2;
                                                      }


                                                      .circle-btn {
                                                         width: 36px;
                                                         height: 36px;
                                                         border-radius: 50%;
                                                         display: flex;
                                                         align-items: center;
                                                         justify-content: center;
                                                         border: 1px solid var(--bs-secondary);
                                                         /* uses Bootstrap color */
                                                         color: var(--bs-secondary);
                                                         background-color: transparent;
                                                         transition: all 0.2s ease;
                                                      }

                                                      .circle-btn:hover {
                                                         background-color: var(--bs-secondary);
                                                         color: white;
                                                         box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
                                                      }

                                                      /* Trend indicator styles */
                                                      .trend-indicator {
                                                         font-size: 12px;
                                                         padding: 4px 8px;
                                                         border-radius: 4px;
                                                         font-weight: 500;
                                                      }

                                                      .trend-indicator.positive {
                                                         background-color: rgba(25, 135, 84, 0.1);
                                                         color: var(--bs-success);
                                                      }

                                                      .trend-indicator.negative {
                                                         background-color: rgba(220, 53, 69, 0.1);
                                                         color: var(--bs-danger);
                                                      }

                                                      /* Custom tooltip styles */
                                                      .custom-tooltip {
                                                         font-family: var(--bs-body-font-family);
                                                      }

                                                      #on_game-tbl th,
                                                      #on_game-tbl td {
                                                         text-align: center;
                                                         font-size: 14px;
                                                         vertical-align: middle;
                                                         /* Para naka-center rin vertically */
                                                      }

                                                      .css-blue {
                                                         max-width: 100%;
                                                         font-family: Inter, sans-serif;
                                                         font-size: 0.75rem;
                                                         /* Slightly smaller font */
                                                         display: inline-flex;
                                                         align-items: center;
                                                         justify-content: center;
                                                         height: 24px;
                                                         /* Reduced height for a badge-like appearance */
                                                         cursor: unset;
                                                         vertical-align: middle;
                                                         box-sizing: border-box;
                                                         padding: 2px 10px;
                                                         /* Reduced padding for a thinner look */
                                                         color: rgb(32, 174, 243);
                                                         background-color: rgba(32, 174, 243, 0.12);
                                                         white-space: nowrap;
                                                         transition: background-color 300ms cubic-bezier(0.4, 0, 0.2, 1), box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1);
                                                         outline: 0px;
                                                         text-decoration: none;
                                                         border-radius: 999px;
                                                      }

                                                      .css-green {
                                                         max-width: 100%;
                                                         font-family: Inter, sans-serif;
                                                         font-size: 0.75rem;
                                                         /* Slightly smaller font */
                                                         display: inline-flex;
                                                         align-items: center;
                                                         justify-content: center;
                                                         height: 24px;
                                                         /* Reduced height for a badge-like appearance */
                                                         cursor: unset;
                                                         vertical-align: middle;
                                                         box-sizing: border-box;
                                                         padding: 2px 10px;
                                                         /* Reduced padding for a thinner look */
                                                         color: rgb(255, 255, 255);
                                                         background-color: rgba(255, 255, 255, 0.12);
                                                         white-space: nowrap;
                                                         transition: background-color 300ms cubic-bezier(0.4, 0, 0.2, 1), box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1);
                                                         outline: 0px;
                                                         text-decoration: none;
                                                         border-radius: 999px;
                                                      }

                                                      .highlighted-row {
                                                         background-color: #fff3cd !important;
                                                         border-left: 4px solid #ffc107;
                                                      }

                                                      #prev-week-btn,
                                                      #next-week-btn {
                                                         background-color: transparent;
                                                         border: 1px solid #e0e0e0;
                                                         color: #666;
                                                         width: 28px;
                                                         height: 28px;
                                                         border-radius: 50%;
                                                         display: flex;
                                                         align-items: center;
                                                         justify-content: center;
                                                         transition: all 0.2s ease;
                                                      }

                                                      #prev-week-btn:hover,
                                                      #next-week-btn:hover {
                                                         background-color: #f5f5f5;
                                                         color: #333;
                                                      }

                                                      #prev-week-btn:focus,
                                                      #next-week-btn:focus {
                                                         box-shadow: none;
                                                         outline: none;
                                                      }

                                                      /* Kim's Brothers Sales Summary spacing & filters */
                                                      .kb-sales-container {
                                                         padding-top: 26px;
                                                         padding-bottom: 8px;
                                                      }

                                                      .kb-sales-header {
                                                         margin-top: 12px;
                                                      }

                                                      .kb-sales-header h4 {
                                                         font-weight: 700;
                                                         letter-spacing: 0.01em;
                                                         color: #111827;
                                                      }

                                                      .kb-sales-header small {
                                                         font-size: 0.8rem;
                                                         color: #6b7280;
                                                      }

                                                      .kb-filter-btn {
                                                         border-radius: 999px;
                                                         padding-inline: 0.95rem;
                                                         font-size: 0.78rem;
                                                         border-color: rgba(148, 163, 184, 0.6);
                                                         color: #111827;
                                                         background-color: #f9fafb;
                                                         box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.02);
                                                      }

                                                      .kb-filter-btn i {
                                                         font-size: 0.8rem;
                                                      }

                                                      .kb-filter-btn:hover {
                                                         background: #eef2ff;
                                                         border-color: #4f46e5;
                                                         color: #111827;
                                                         box-shadow: 0 8px 16px rgba(15, 23, 42, 0.08);
                                                      }

                                                      .kb-sales-filters {
                                                         justify-content: flex-end;
                                                         gap: 0.5rem;
                                                      }

                                                      .kb-summary-row {
                                                         margin-top: 6px;
                                                      }

                                                      .kb-summary-card {
                                                         border-radius: 14px;
                                                         border: 1px solid rgba(148, 163, 184, 0.24);
                                                         background: #ffffff;
                                                         box-shadow: 0 10px 24px rgba(15, 23, 42, 0.05);
                                                         transition: transform 0.16s ease, box-shadow 0.16s ease;
                                                      }

                                                      .kb-summary-card .card-body {
                                                         padding: 1.25rem 1.4rem;
                                                      }

                                                      .kb-summary-card .fs-4,
                                                      .kb-summary-card .fs-5 {
                                                         letter-spacing: 0.01em;
                                                      }

                                                      .kb-summary-card:hover {
                                                         transform: translateY(-1px);
                                                         box-shadow: 0 14px 30px rgba(15, 23, 42, 0.09);
                                                      }

                                                      .kb-summary-card small {
                                                         font-size: 0.78rem;
                                                      }

                                                      /* Per-card accent colors for metric tiles */
                                                      .kb-summary-row > div:nth-child(1) .kb-summary-card {
                                                         border-color: rgba(22, 163, 74, 0.35);
                                                         background: radial-gradient(circle at top left, #dcfce7 0, #ffffff 55%);
                                                      }

                                                      .kb-summary-row > div:nth-child(1) .kb-summary-card .fs-4,
                                                      .kb-summary-row > div:nth-child(1) .kb-summary-card .fs-5 {
                                                         color: #166534;
                                                      }

                                                      .kb-summary-row > div:nth-child(2) .kb-summary-card {
                                                         border-color: rgba(59, 130, 246, 0.3);
                                                         background: radial-gradient(circle at top left, #e0f2fe 0, #ffffff 55%);
                                                      }

                                                      .kb-summary-row > div:nth-child(2) .kb-summary-card .fs-5 {
                                                         color: #1d4ed8;
                                                      }

                                                      .kb-summary-row > div:nth-child(3) .kb-summary-card {
                                                         border-color: rgba(249, 115, 22, 0.3);
                                                         background: radial-gradient(circle at top left, #ffedd5 0, #ffffff 55%);
                                                      }

                                                      .kb-summary-row > div:nth-child(3) .kb-summary-card .fs-5 {
                                                         color: #ea580c;
                                                      }

                                                      .kb-summary-row > div:nth-child(4) .kb-summary-card {
                                                         border-color: rgba(99, 102, 241, 0.3);
                                                         background: radial-gradient(circle at top left, #e0e7ff 0, #ffffff 55%);
                                                      }

                                                      .kb-summary-row > div:nth-child(4) .kb-summary-card .fs-5 {
                                                         color: #4f46e5;
                                                      }

                                                      .kb-summary-row > div:nth-child(5) .kb-summary-card {
                                                         border-color: rgba(13, 148, 136, 0.35);
                                                         background: radial-gradient(circle at top left, #ccfbf1 0, #ffffff 55%);
                                                      }

                                                      .kb-summary-row > div:nth-child(5) .kb-summary-card .fs-5 {
                                                         color: #0f766e;
                                                      }

                                                      .kb-sales-container .card.mb-3 {
                                                         border-radius: 18px;
                                                         border: 1px solid rgba(22, 163, 74, 0.25);
                                                         box-shadow: 0 18px 40px rgba(22, 163, 74, 0.12);
                                                         background: radial-gradient(circle at top left, #dcfce7 0, #ffffff 55%);
                                                      }

                                                      .kb-sales-container .card.mb-3 .card-header {
                                                         border-bottom: 0;
                                                         padding: 0.85rem 1.4rem 0.15rem;
                                                         display: flex;
                                                         align-items: center;
                                                         justify-content: space-between;
                                                      }

                                                      .kb-sales-container .card.mb-3 .card-header h6 {
                                                         font-weight: 600;
                                                         letter-spacing: 0.04em;
                                                         text-transform: uppercase;
                                                         font-size: 0.8rem;
                                                         color: #14532d;
                                                      }

                                                      .kb-sales-container .card.mb-3 .card-body {
                                                         padding-top: 0.6rem;
                                                         padding-bottom: 1.3rem;
                                                      }

                                                      /* Time filter dropdown */
                                                      .kb-time-filter {
                                                         position: relative;
                                                      }

                                                      .kb-time-menu {
                                                         position: absolute;
                                                         top: 110%;
                                                         right: 0;
                                                         min-width: 260px;
                                                         z-index: 1050;
                                                         display: none;
                                                         border-radius: 12px;
                                                      }

                                                      .kb-time-menu.show {
                                                         display: block;
                                                      }

                                                      .kb-time-option + .kb-time-option {
                                                         border-top: 1px solid rgba(229, 231, 235, 0.8);
                                                      }

                                                      .kb-sales-container .card:last-of-type {
                                                         border-radius: 14px;
                                                         border: 1px solid rgba(148, 163, 184, 0.2);
                                                         box-shadow: 0 10px 24px rgba(15, 23, 42, 0.04);
                                                         background: #ffffff;
                                                      }

                                                      .kb-sales-container .table thead th {
                                                         font-size: 0.78rem;
                                                         text-transform: uppercase;
                                                         letter-spacing: 0.06em;
                                                         color: #6b7280;
                                                         border-bottom: 1px solid rgba(148, 163, 184, 0.35);
                                                         background: linear-gradient(90deg, #f9fafb, #eef2ff);
                                                      }

                                                      .kb-sales-container .table tbody td {
                                                         font-size: 0.82rem;
                                                         vertical-align: middle;
                                                         border-bottom: 1px solid rgba(243, 244, 246, 1);
                                                      }

                                                      .kb-sales-container .table tbody tr {
                                                         transition: background-color 0.15s ease, transform 0.15s ease;
                                                      }

                                                      .kb-sales-container .table tbody tr:nth-child(odd) {
                                                         background: linear-gradient(90deg, rgba(239, 246, 255, 0.55), #ffffff);
                                                      }

                                                      .kb-sales-container .table tbody tr:nth-child(even) {
                                                         background: #ffffff;
                                                      }

                                                      .kb-sales-container .table tbody tr:hover {
                                                         background: linear-gradient(90deg, #eef2ff, #e0f2fe);
                                                         transform: translateY(-1px);
                                                      }

                                                      /* Accent colors for numeric columns */
                                                      .kb-sales-container .table tbody td.text-end:nth-child(2) {
                                                         color: #16a34a; /* total sales */
                                                         font-weight: 600;
                                                      }

                                                      .kb-sales-container .table tbody td.text-end:nth-child(4) {
                                                         color: #f97316; /* discount */
                                                      }

                                                      .kb-sales-container .table tbody td.text-end:nth-child(5),
                                                      .kb-sales-container .table tbody td.text-end:nth-child(7) {
                                                         color: #0f766e; /* net & gross profit */
                                                         font-weight: 600;
                                                      }

                                                      @media (max-width: 768px) {
                                                         .kb-sales-header {
                                                            align-items: flex-start !important;
                                                         }

                                                         .kb-sales-filters {
                                                            justify-content: flex-start !important;
                                                         }

                                                         .kb-summary-card .card-body {
                                                            padding: 1.05rem 1.1rem;
                                                         }
                                                      }
                                                   </style>