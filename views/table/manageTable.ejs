<!-- ============================================ -->
<!-- TABLE MANAGEMENT PAGE -->
<!-- File: views/table/manageTable.ejs -->
<!-- Description: Main page for managing restaurant tables -->
<!-- ============================================ -->

<%- include('../partials/header') %>
<%- include('../partials/loader') %>
	<%- include('../partials/sidebar') %>

		<%- include('../partials/topbar') %>

			<div class="container-fluid content-inner mt-4">
				<div class="row">
					<div class="col-sm-12">
						<div class="card">
							<div class="card-header d-flex justify-content-between align-items-center">
								<h3 class="card-title"><div class="breadcrumb1 flat">
									<a href="/dashboard" ><span class="fa fa-home"></span></a>
									<a href="/manageTable"class="active"><%= __('table.manage_restaurant_tables') %></a>
								</div></h3>
									<button type="button" class="btn btn-primary" onclick="add_restaurant_table_modal()">
										<i class="fa fa-plus" aria-hidden="true"></i> <%= __('table.new_table') %>
									</button>
							</div>

							<!-- ============================================ -->
							<!-- FILTERS SECTION -->
							<!-- ============================================ -->
							<div class="card-body border-bottom bg-light py-2">
								<div class="row g-2 align-items-center">
									<div class="col-auto">
										<label class="form-label fw-bold mb-0" style="font-size: 12px;"><%= __('table.status') %>:</label>
										<select class="form-control form-select form-select-sm" id="filter_status" style="width: 150px; font-size: 12px;">
											<option value=""><%= __('table.all') %></option>
											<option value="1"><%= __('table.available') %></option>
											<option value="2"><%= __('table.occupied') %></option>
											<option value="4"><%= __('table.reserved') %></option>
											<option value="3"><%= __('table.not_available') %></option>
										</select>
									</div>
									<div class="col-auto ms-auto">
										<label class="form-label fw-bold mb-0" style="font-size: 12px;"><%= __('table.pagination.search') %>:</label>
										<input type="text" class="form-control form-control-sm" id="search_input" placeholder="<%= __('table.pagination.search_placeholder') %>" style="width: 200px; font-size: 12px;">
									</div>
								</div>
							</div>

							<div class="card-body pt-3">
								<div class="table-responsive">
									<table id="restaurantTables" class="table  nowrap small-text" style="width:100%">
										<thead class="table-light">
											<tr>
												<th><%= __('table.table_number') %></th>
												<th><%= __('table.capacity') %></th>
												<th><%= __('table.status') %></th>
												<th><%= __('table.branch') %></th>
												<th><%= __('table.actions') %></th>
											</tr>
										</thead>
										<tbody></tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>


			<!-- ============================================ -->
			<!-- MODALS -->
			<!-- ============================================ -->
			<%- include ('../modals/table/newTable'); %>
			<%- include ('../modals/table/editTable'); %>
			<%- include ('../modals/table/transactionHistory'); %>
			<%- include ('../modals/table/transactionHistory'); %>

			<!-- ============================================ -->
			<!-- FOOTER -->
			<!-- ============================================ -->
			<%- include ('../partials/footer'); -%>

			<!-- Translations passed via data attribute to avoid linter issues -->
			<div id="manageTableTranslations" 
				data-success="<%- __('table.success') %>"
				data-error="<%- __('table.error') %>"
				data-table-created-successfully="<%- __('table.table_created_successfully') %>"
				data-table-updated-successfully="<%- __('table.table_updated_successfully') %>"
				data-table-deleted-successfully="<%- __('table.table_deleted_successfully') %>"
				data-failed-to-create-table="<%- __('table.failed_to_create_table') %>"
				data-failed-to-update-table="<%- __('table.failed_to_update_table') %>"
				data-failed-to-delete-table="<%- __('table.failed_to_delete_table') %>"
				data-failed-to-load-tables="<%- __('table.failed_to_load_tables') %>"
				data-delete-confirmation-title="<%- __('table.delete_confirmation_title') %>"
				data-delete-confirmation-text="<%- __('table.delete_confirmation_text') %>"
				data-delete-confirm-button="<%- __('table.delete_confirm_button') %>"
				data-all="<%- __('table.all') %>"
				data-available="<%- __('table.available') %>"
				data-occupied="<%- __('table.occupied') %>"
				data-reserved="<%- __('table.reserved') %>"
				data-not-available="<%- __('table.not_available') %>"
				data-unknown="<%- __('table.unknown') %>"
				data-pagination-showing="<%- __('table.pagination.showing') %>"
				data-pagination-to="<%- __('table.pagination.to') %>"
				data-pagination-of="<%- __('table.pagination.of') %>"
				data-pagination-entries="<%- __('table.pagination.entries') %>"
				data-pagination-previous="<%- __('table.pagination.previous') %>"
				data-pagination-next="<%- __('table.pagination.next') %>"
				data-pagination-search="<%- __('table.pagination.search') %>"
				data-pagination-search-placeholder="<%- __('table.pagination.search_placeholder') %>"
				style="display: none;"></div>

			<!-- Table context for admin branch checks -->
			<div id="tableContextData"
				data-permissions="<%= (typeof permissions !== 'undefined' && permissions !== null) ? permissions : 0 %>"
				data-branch-id="<%= (typeof branch_id !== 'undefined' && branch_id !== null) ? branch_id : '' %>"
				style="display: none;"></div>

			<!-- ============================================ -->
			<!-- SCRIPTS -->
			<!-- ============================================ -->
			<script src="/assets/js/functions/manageTable.js?v=2026-01-21-branch"></script>

			<style>
				/* Keep tables readable when horizontal overflow is needed */
				.card-body {
					overflow-x: auto;
				}

				#restaurantTables {
					width: 100%;
					font-size: 13px;
					border-collapse: collapse;
				}

				#restaurantTables thead th {
					background: var(--bs-primary-bg-subtle);
					color: var(--bs-primary);
					font-weight: 500;
					padding: 12px 15px;
					text-align: left;
					border: none;
				}

				#restaurantTables tbody tr {
					border-bottom: 1px solid #eee;
				}

				#restaurantTables td {
					padding: 12px 15px;
					color: #666;
				}

				#restaurantTables tbody tr:hover {
					background-color: #f5f5f5 !important;
				}

				.bg-light {
					background-color: #f8f9fa !important;
				}

				.border-bottom {
					border-bottom: 2px solid #dee2e6 !important;
				}

				.form-label.fw-bold {
					font-size: 12px;
					color: #495057;
					margin-bottom: 5px;
				}

				#filter_status,
				#search_input {
					font-size: 12px;
				}
			</style>
