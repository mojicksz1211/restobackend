<!-- ============================================ -->
<!-- BILLING MANAGEMENT PAGE -->
<!-- File: views/billing/manageBilling.ejs -->
<!-- Description: Displays billing records -->
<!-- ============================================ -->

<%- include('../partials/header') %>
<%- include('../partials/loader') %>
<%- include('../partials/sidebar') %>
<%- include('../partials/topbar') %>

<div class="container-fluid content-inner mt-4">
	<div class="row">
		<div class="col-sm-12">
			<div class="card">
				<div class="card-header d-flex justify-content-between align-items-center">
					<h3 class="card-title">
						<div class="breadcrumb1 flat">
							<a href="/dashboard"><span class="fa fa-home"></span></a>
							<a href="/billing" class="active"><%= __('sidebar.billing') %></a>
						</div>
					</h3>
				</div>
				<div class="card-body">
					<div class="table-responsive">
						<table id="billingTable" class="table table-hover small-text" style="width:100%">
							<thead>
								<tr>
									<th>Order #</th>
									<th>Payment Method</th>
									<th>Amount Due</th>
									<th>Amount Paid</th>
									<th>Payment Ref</th>
									<th>Status</th>
									<th>Encoded At</th>
									<th>Encoded By</th>
									<th class="text-center">Payments</th>
									<th class="text-center">Actions</th>
								</tr>
							</thead>
							<tbody></tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Payment Modal -->
<div class="modal fade" id="modal-payment" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<form id="payment_form">
				<input type="hidden" id="payment_order_id">
				<div class="modal-header bg-primary text-white">
					<h5 class="modal-title" id="paymentModalLabel">Process Payment - <span id="payment_order_no"></span></h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row g-3">
						<div class="col-12">
							<div class="p-3 bg-light rounded border mb-3">
								<div class="d-flex justify-content-between mb-1">
									<span class="text-muted">Amount Due:</span>
									<span class="fw-bold text-dark" id="display_amount_due">0.00</span>
								</div>
								<div class="d-flex justify-content-between">
									<span class="text-muted">Balance:</span>
									<span class="fw-bold text-danger" id="display_balance">0.00</span>
								</div>
							</div>
						</div>
						<div class="col-md-12">
							<label class="form-label">Payment Method</label>
							<select class="form-control" id="payment_method" required>
								<option value="CASH">CASH</option>
								<option value="GCASH">GCASH</option>
								<option value="MAYA">MAYA</option>
								<option value="CARD">CARD</option>
							</select>
						</div>
						<div class="col-md-12">
							<label class="form-label">Amount Paid (Bayad Ngayon)</label>
							<div class="input-group">
								<span class="input-group-text">â‚±</span>
								<input type="number" step="0.01" min="0" class="form-control fw-bold" id="amount_paid" placeholder="Input amount to pay..." required>
							</div>
						</div>
						<div class="col-12">
							<label class="form-label">Payment Reference (Optional)</label>
							<input type="text" class="form-control" id="payment_ref" placeholder="OR number / Transaction ID">
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="submit" class="btn btn-primary">Save Payment</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- Payment History Modal -->
<div class="modal fade" id="modal-payment-history" tabindex="-1" aria-labelledby="paymentHistoryLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header bg-dark text-white">
				<h5 class="modal-title" id="paymentHistoryLabel">Payment Breakdown - <span id="payment_history_order_no"></span></h5>
				<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="table-responsive">
					<table class="table table-sm table-striped" id="paymentHistoryTable" style="width:100%">
						<thead>
							<tr>
								<th>Date</th>
								<th>Method</th>
								<th>Amount</th>
								<th>Reference</th>
								<th>Encoded By</th>
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<%- include('../partials/footer') %>
<script src="/assets/js/functions/manageBilling.js"></script>
<style>
	.card-body {
		overflow-x: auto;
	}

	#billingTable th {
		font-size: 12px;
		font-weight: 600;
	}
</style>
